"use strict";function diServerDirective(e){return{restrict:"EA",scope:{endpoint:"@",cors:"@"},link:function(t,i,r){e.configure(r.endpoint,r.cors)}}}function diRScriptDirective(e){return{restrict:"E",scope:{name:"@",author:"@",directory:"@",inputs:"@",outputs:"@",onload:"@"},compile:function(){return{pre:function(t,i,r){e.registarScript({name:r.name,author:r.author,directory:r.directory,inputs:r.inputs,outputs:r.outputs,onload:r.onload})}}}}}function diRCodeDirective(e){return{restrict:"E",scope:{name:"@",inputs:"@",outputs:"@",onload:"@"},link:function(t,i,r){var n=i.html();i.html(""),e.registarCode(r.name,n,r.inputs,r.outputs,r.onload)}}}function diInputDirective(e,t,i){return{restrict:"E",scope:{label:"@",placeholder:"@",rtype:"@",rinput:"@",rscript:"@"},link:function(e,r,n){var o=n.rscript,a=n.rinput,c=t("<md-input-container><label>"+n.label+'</label><input ng-model="rscript.'+o+".inputs."+a+'" placeholder=""></md-input-container>');"true"===n.watch&&i.rscript[o].watches.push(a),i.rscript[o].rtypes[a]=n.rtype,r.append(c(i))}}}function diSliderDirective(e,t,i,r){return{restrict:"E",scope:{value:"@",max:"@",min:"@",rtype:"@",rinput:"@",rscript:"@"},link:function(n,o,a){var c,l,s=a.rscript,d=a.rinput,p=a.min||0,u=a.max||100,m=a.value||0,g=a.step||1;"true"===a.watch,i.rscript[s].inputs[d]=m,i.rscript[s].rtypes[d]=a.rtype,l=t('<md-slider flex min="'+p+'" max="'+u+'"ng-model="rscript.'+s+".inputs."+d+'"id="red-slider" aria-label="red" md-discrete class step="'+g+'"></md-slider>'),o.append(l(i)),"true"===a.watch&&i.$watch("rscript."+s+".inputs."+d,function(t,n){t!==n&&(r.cancel(c),c=r(function(){e.exe(i.rscript[s])},a.debounce||500))},!0)}}}function diCheckboxDirective(e,t,i){return{restrict:"E",transclude:!1,scope:{value:"@",rtype:"@",rinput:"@",rscript:"@"},link:function(e,r,n){var o=n.rscript,a=n.rinput,c="true"===n.value?!0:!1,l=angular.element(r);"true"===n.watch&&i.rscript[o].watches.push(a),i.rscript[o].inputs[a]=c,i.rscript[o].rtypes[a]=n.rtype;var s='<md-checkbox ng-model="rscript.'+o+".inputs."+a+'">'+r.html()+"</md-checkbox>";l.empty(),l.append(t(s)(i))}}}function diSelectDirective(e,t,i){return{restrict:"E",scope:{placeholder:"@",label:"@",selected:"@",watch:"@",rtype:"@",rinput:"@",rscript:"@"},link:function(e,r,n){var o=n.rscript,a=n.rinput,c=n.selected,l=n.placeholder||"",s=n.label?'<p style="margin-bottom:5px;">'+n.label+"</p>":"",d=angular.element(r);if(c)switch(n.rtype){case"numeric":c=parseFloat(c);break;case"integer":c=parseInt(c);break;case"logical":c="true"===c?!0:!1}"true"===n.watch&&i.rscript[o].watches.push(a),i.rscript[o].inputs[a]=c,i.rscript[o].rtypes[a]=n.rtype;var p=s+"<md-select"+(n.label?' style="margin-top:0px;"':"")+' placeholder="'+l+'" ng-model="rscript.'+o+".inputs."+a+'">'+r.html().replace(/di-/gi,"md-")+"</md-select>";d.empty(),d.append(t(p)(i))}}}function diPlotDirective(e,t,i){return{restrict:"E",scope:{height:"@",width:"@",routput:"@",rscript:"@"},link:function(e,r,n){var o=n.rscript,a=n.routput,c=n.height,l=(n.width,angular.element(r)),s='<img ng-src="{{rscript.'+o+".outputs."+a+'}}" height="'+c+'"/>';l.empty(),l.append(t(s)(i))}}}function diTableDirective(){return{restrict:"E",scope:{headers:"=",content:"=",sortable:"=",filters:"=",customClass:"=customClass",thumbs:"=",count:"="},controller:["$scope","$filter",function(e,t){var i=t("orderBy");e.tablePage=0,e.nbOfPages=function(){return Math.ceil(e.content.length/e.count)},e.handleSort=function(t){return e.sortable.indexOf(t)>-1?!0:!1},e.order=function(t,r){e.content=i(e.content,t,r),e.predicate=t},e.order(e.sortable[0],!1),e.getNumber=function(e){return new Array(e)},e.goToPage=function(t){e.tablePage=t}}],template:angular.element(document.querySelector("#di-table-template")).html()}}function diColresizeDirective(e){return{restrict:"A",link:function(t){t.$evalAsync(function(){e(function(){},100)})}}}var app=angular.module("deployrUi.directives",["deployrUi"]);diServerDirective.$inject=["$deployr"],diRScriptDirective.$inject=["$deployr"],diRCodeDirective.$inject=["$deployr"],diInputDirective.$inject=["$deployr","$compile","$rootScope"],diSliderDirective.$inject=["$deployr","$compile","$rootScope","$timeout"],diCheckboxDirective.$inject=["$deployr","$compile","$rootScope"],diSelectDirective.$inject=["$deployr","$compile","$rootScope"],diPlotDirective.$inject=["$deployr","$compile","$rootScope"],diTableDirective.$inject=["$deployr"],diColresizeDirective.$inject=["$timeout"],app.directive("diServer",diServerDirective).directive("diRscript",diRScriptDirective).directive("diRcode",diRCodeDirective).directive("diInput",diInputDirective).directive("diSlider",diSliderDirective).directive("diCheckbox",diCheckboxDirective).directive("diSelect",diSelectDirective).directive("diPlot",diPlotDirective).directive("diTable",diTableDirective).directive("diColresize",diColresizeDirective),angular.module("deployrUi",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMaterial","deployrUi.directives","deployrUi.core"]),angular.module("deployrUi").controller("NavbarCtrl",["$scope",function(e){e.date=new Date}]),angular.module("deployrUi").controller("ContentCtrl",["$scope",function(e){e.toggleSearch=!1,e.headers=[{name:"",field:"thumb"},{name:"Name",field:"name"},{name:"Description",field:"description"},{name:"Last Modified",field:"last_modified"}],e.content=[{thumb:"https://lh3.googleusercontent.com/-5NfcdlvGQhs/AAAAAAAAAAI/AAAAAAAAABY/ibGrApGYTuQ/photo.jpg",name:"Bruno Mars",description:"Human",last_modified:"Jun 5, 2014"},{thumb:"http://www.otakia.com/wp-content/uploads/V_1/article_3573/7405.jpg",name:"AT-AT",description:"Robot",last_modified:"Jun 5, 2014"},{thumb:"https://speakerdata.s3.amazonaws.com/photo/image/774492/Mark-Ronson-r24.jpg",name:"Mark Ronson",description:"Human",last_modified:"Jun 5, 2014"},{thumb:"http://25.media.tumblr.com/61ebf04c3cc7a84944aa0246e902f2a7/tumblr_mm35b87dGz1qmwrnuo1_1280.jpg",name:"Daft Punk",description:"Human-Robot",last_modified:"Jun 5, 2014"},{thumb:"http://thatgrapejuice.net/wp-content/uploads/2014/03/lady-gaga-that-grape-juice-televisionjpg.jpg",name:"Lady Gaga",description:"Undefined",last_modified:"Jun 5, 2014"}],e.custom={name:"bold",description:"grey",last_modified:"grey"},e.sortable=["name","description","last_modified"],e.thumbs="thumb",e.count=3}]),function(){function e(e,t){function i(e,i){var r=Object.keys(t.rscript[e].outputs),n=[];i.get("artifacts")&&i.get("artifacts").forEach(function(i){-1!=r.indexOf(i.filename)&&(t.rscript[e].outputs[i.filename]=i.url,n.push(i.filename))}),r.forEach(function(r){var o=i.workspace(r);o&&(t.rscript[e].outputs[o.name]=o.value,n.push(o.name))}),i.get("results")&&i.get("results").forEach(function(i){for(var r in t.rscript[e].outputs)-1===n.indexOf(r)&&(t.rscript[e].outputs[r]=i.url,n.push(r))}),t.$apply()}function r(e){n=(n||o).io("/r/repository/script/execute"),n.data(e.data);for(var t in e.inputs){var r=e.rtypes[t];console.log(t+" --> "+r+" = "+e.inputs[t]);try{n[r](t,e.inputs[t])}catch(a){}}n.routputs(Object.keys(e.outputs)).error(function(e){console.log(e)}).end(function(t){i(e.id,t)})}var n,o=e.deployr,a={};return t.rscript={},t.rcode={},{configure:function(e,t){a={host:e,cors:t},o.configure(a)},registarScript:function(e){var i=e.name;i=i.slice(0,-2);var n={},o={};(e.inputs||[]).split(",").forEach(function(e){n[e]="",o[e]={name:e,type:null}});var a={};(e.outputs||[]).split(",").forEach(function(e){a[e]=""}),t.rscript[i]={id:i,watches:[],onload:e.onload||!1,inputs:n,outputs:a,rtypes:o,data:{author:e.author,directory:e.directory||"root",filename:e.name}},console.log(t.rscript),t.$watch("rscript."+i+".inputs",function(e,n){for(var o in e)e[o]!==n[o]&&-1!=t.rscript[i].watches.indexOf(o)&&(console.log('input "'+o+'" changed execute script "'+i+'"'),r(t.rscript[i]));t.rscript[i].onload&&(t.rscript[i].onload=!1,r(t.rscript[i]))},!0)},registarCode:function(e,i,r,n,o){t.rcode[e]={code:i,inputs:r,outputs:n,onload:o||!1},console.log(t.rcode)},exe:function(e){r(e)}}}angular.module("deployrUi.core",[]).service("$deployr",e),e.$inject=["$window","$rootScope"]}(),angular.module("deployrUi").config(["$mdIconProvider",function(e){e.defaultIconSet("my/app/icons.svg")}]).controller("MainCtrl",["$scope",function(e){e.awesomeThings=[{title:"AngularJS",url:"https://angularjs.org/",description:"HTML enhanced for web apps!",logo:"angular.png"},{title:"BrowserSync",url:"http://browsersync.io/",description:"Time-saving synchronised browser testing.",logo:"browsersync.png"},{title:"GulpJS",url:"http://gulpjs.com/",description:"The streaming build system.",logo:"gulp.png"},{title:"Jasmine",url:"http://jasmine.github.io/",description:"Behavior-Driven JavaScript.",logo:"jasmine.png"},{title:"Karma",url:"http://karma-runner.github.io/",description:"Spectacular Test Runner for JavaScript.",logo:"karma.png"},{title:"Protractor",url:"https://github.com/angular/protractor",description:"End to end test framework for AngularJS applications built on top of WebDriverJS.",logo:"protractor.png"},{title:"Angular Material Design",url:"https://material.angularjs.org/#/",description:"The Angular reference implementation of the Google's Material Design specification.",logo:"angular-material.png"},{title:"Less",url:"http://lesscss.org/",description:"Less extends the CSS language, adding features that allow variables, mixins, functions and many other techniques.",logo:"less.png"}],angular.forEach(e.awesomeThings,function(e){e.rank=Math.random()})}]).filter("startFrom",function(){return function(e,t){return t=+t,e.slice(t)}}),angular.module("deployrUi").run(["$templateCache",function(e){e.put("app/components/content/content.html",'<div ng-controller="ContentCtrl"><div layout="row" style="margin: 25px; padding:25px"><div flex=""><div ng-include="\'app/components/content/view.html\'"></div></div></div></div>'),e.put("app/components/content/dt.html",'<div layout="column"><div class="main-fab"><md-button class="md-fab md-accent">+</md-button></div><md-toolbar layout="column" class="md-small"><span flex="flex"></span><div class="md-toolbar-tools"><div layout="row" flex="flex" class="fill-height"><div ng-hide="toggleSearch" class="md-toolbar-item md-breadcrumb"><span>Angular Material Table</span></div><span flex="flex" ng-hide="toggleSearch"></span><md-input-container flex="flex" style="padding-left:88px;" ng-show="toggleSearch"><input type="text" ng-model="search"></md-input-container><div layout="row" class="md-toolbar-item md-tools"><a href="href" ng-click="toggleSearch = !toggleSearch" class="md-button md-default-theme"><i class="ion-android-search"></i></a></div></div></div></md-toolbar><md-content layout="column" flex="flex" ng-click="toggleSearch=false"><di-table headers="headers" content="content" sortable="sortable" filters="search" custom-class="custom" thumbs="thumbs" count="count"></di-table></md-content><template id="di-table-template"><table di-colresize="di-colresize" class="di-table"><thead><tr class="di-table-headers-row"><th ng-repeat="h in headers" class="di-table-header"><a href="#" ng-if="handleSort(h.field)" ng-click="reverse=!reverse;order(h.field,reverse)">{{h.name}} <i ng-show="reverse &amp;&amp; h.field == predicate" class="ion-android-arrow-dropup"></i><i ng-show="!reverse &amp;&amp; h.field == predicate" class="ion-android-arrow-dropdown"></i></a><span ng-if="!handleSort(h.field)">{{h.name}}</span></th><th class="di-table-header"></th></tr></thead><tbody><tr ng-repeat="c in content | filter:filters | startFrom:tablePage*count | limitTo: count" class="di-table-content-row"><td><div ng-repeat="h in headers" ng-if="h.field == thumbs" class="di-table-thumbs"><div style="background-image:url({{c.thumb}})"></div></div></td><td ng-repeat="h in headers" ng-class="customClass[h.field]" ng-if="h.field != thumbs" class="di-table-content">{{(h.field.indexOf(\'date\') > 0) ? $filter(\'date\')(c[h.field]) : c[h.field];}}</td><td class="di-table-td-more"><md-button aria-label="Info"><i class="ion-android-more-vertical"></i></md-button></td></tr></tbody></table><div layout="row" class="di-table-footer"><span class="di-table-count-info">Rows per page : <a href="#" ng-click="goToPage(0); count=10">10</a>,<a href="#" ng-click="goToPage(0); count=25">25</a>,<a href="#" ng-click="goToPage(0); count=50">50</a>,<a href="#" ng-click="goToPage(0); count=100">100</a>(current is {{count}})</span><span flex="flex"></span><span ng-show="nbOfPages() &gt; 1"><md-button ng-disabled="tablePage==0" ng-click="tablePage=tablePage-1" aria-label="Previous Page" class="md-primary md-hue-2"><i style="font-size:16px;" class="ion-chevron-left"></i></md-button><a href="#" ng-repeat="i in getNumber(nbOfPages()) track by $index"><md-button ng-click="goToPage($index)" class="md-primary md-hue-2 di-table-footer-item"><span ng-class="{ \'di-table-active-page\': tablePage==$index}">{{$index+1}}</span></md-button></a><md-button ng-disabled="tablePage==nbOfPages()-1" ng-click="tablePage=tablePage+1" aria-label="Next Page" class="md-primary md-hue-2"><i style="font-size:16px;" class="ion-chevron-right"></i></md-button></span></div></template></div>'),e.put("app/components/content/view.html",'<div di-server="" endpoint="http://deployr-7.4.x-trunk.deployr.co:7400" cors="true"><di-rscript name="myScript.R" author="swells" directory="root" inputs="n_breaks,individual_obs,density,bw_adjust" outputs="plot" onload="true"></di-rscript><di-select placeholder="20" rscript="myScript" rinput="n_breaks" rtype="numeric" label="Number of bins in histogram (approximate):" watch="true" selected="50"><di-option value="10">10</di-option><di-option value="20">20</di-option><di-option value="35">35</di-option><di-option value="50">50</di-option></di-select><di-checkbox rscript="myScript" rinput="individual_obs" rtype="logical" watch="true">Show individual observations</di-checkbox><di-checkbox rscript="myScript" rinput="density" rtype="logical" watch="true">Show density estimate</di-checkbox><di-plot rscript="myScript" routput="plot" lllheight="300px"></di-plot><di-slider ng-show="rscript.myScript.inputs.density" rscript="myScript" rinput="bw_adjust" rtype="numeric" watch="true" min="0.2" max="2" value="1" step="0.2"></di-slider></div>'),e.put("app/components/navbar/navbar.html",'<md-toolbar class="md-default-theme" layout="row" layout-align="center center" ng-controller="NavbarCtrl"><md-button href="https://github.com/Swiip/generator-gulp-angular">DeployR</md-button><md-button href="#">Current date: {{ date | date:\'yyyy-MM-dd\' }}</md-button></md-toolbar>')}]);